# Local convenience: run a test PostgreSQL container for manual testing.
# Integration tests use Testcontainers directly and do NOT require this file.
#
# Usage:
#   docker compose -f docker-compose.test.yml up -d
#   DATABASE_URL=postgresql://test:test@localhost:5433/raid_ledger_test npm run test:integration -w api
#   docker compose -f docker-compose.test.yml down -v
services:
  test-postgres:
    image: postgres:15-alpine
    environment:
      POSTGRES_USER: test
      POSTGRES_PASSWORD: test
      POSTGRES_DB: raid_ledger_test
    ports:
      - '5433:5432'
    healthcheck:
      test: ['CMD-SHELL', 'pg_isready -U test -d raid_ledger_test']
      interval: 5s
      timeout: 5s
      retries: 5
